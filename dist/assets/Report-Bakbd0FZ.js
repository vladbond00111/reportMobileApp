import{d as $,p as E,q as R,s as P,v as W,x as q,y as M,z as A,A as j,f as v,_ as N,r as m,o as k,j as I,a as e,w as u,b as g,F as T,B as z,C as H,D as L,E as O,c as S,i as y,k as Q,t as C,e as F}from"./index-CEtYVSE0.js";import{p as G,s as J,u as K,d as X}from"./useDatabase-o04XfflN.js";const Y=$({components:{IonButtons:E,IonButton:R,IonModal:P,IonHeader:W,IonContent:q,IonToolbar:M,IonTitle:A,IonInput:j},setup(o,{emit:l}){const i=v(),s=v({nickname:"",name:"",birthdate:"",rank:"",workPosition:"",phone:"",unit:"",unit2:"",unit3:"",unit4:"",unit5:""});return{modal:i,form:s,cancel:()=>i.value.$el.dismiss(null,"cancel"),confirm:async()=>{await G(s.value),l("new-staff",s.value),i.value.$el.dismiss(name,"confirm")},onWillDismiss:async p=>{p.detail.role}}}});function Z(o,l,i,s,V,w){const d=m("ion-button"),p=m("ion-buttons"),c=m("ion-title"),r=m("ion-toolbar"),U=m("ion-header"),b=m("ion-textarea"),a=m("ion-input"),f=m("ion-content"),B=m("ion-modal");return k(),I(T,null,[e(d,{id:"open-modal",style:{margin:"0 0 16px 10px"},expand:"block",color:"primary"},{default:u(()=>[g(" Створити ")]),_:1}),e(B,{ref:"modal",trigger:"open-modal",onWillDismiss:o.onWillDismiss},{default:u(()=>[e(U,null,{default:u(()=>[e(r,null,{default:u(()=>[e(p,{slot:"start"},{default:u(()=>[e(d,{color:"primary",onClick:l[0]||(l[0]=t=>o.cancel())},{default:u(()=>[g("Cancel")]),_:1})]),_:1}),e(c,null,{default:u(()=>[g("Картка бійця")]),_:1}),e(p,{slot:"end"},{default:u(()=>[e(d,{color:"primary",strong:!0,onClick:l[1]||(l[1]=t=>o.confirm())},{default:u(()=>[g("Confirm")]),_:1})]),_:1})]),_:1})]),_:1}),e(f,{class:"ion-padding"},{default:u(()=>[e(b,{modelValue:o.form.nickname,"onUpdate:modelValue":l[2]||(l[2]=t=>o.form.nickname=t),class:"ion-margin-bottom",label:"Позивний","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"]),e(a,{modelValue:o.form.name,"onUpdate:modelValue":l[3]||(l[3]=t=>o.form.name=t),class:"ion-margin-bottom",label:"ПІБ","label-placement":"floating",fill:"outline",mode:"md"},null,8,["modelValue"]),e(a,{modelValue:o.form.birthdate,"onUpdate:modelValue":l[4]||(l[4]=t=>o.form.birthdate=t),class:"ion-margin-bottom",label:"Дата народження","label-placement":"floating",fill:"outline",mode:"md"},null,8,["modelValue"]),e(a,{modelValue:o.form.rank,"onUpdate:modelValue":l[5]||(l[5]=t=>o.form.rank=t),class:"ion-margin-bottom",label:"Звання","label-placement":"floating",fill:"outline",mode:"md"},null,8,["modelValue"]),e(a,{modelValue:o.form.workPosition,"onUpdate:modelValue":l[6]||(l[6]=t=>o.form.workPosition=t),class:"ion-margin-bottom",label:"Посада","label-placement":"floating",fill:"outline",mode:"md"},null,8,["modelValue"]),e(a,{modelValue:o.form.phone,"onUpdate:modelValue":l[7]||(l[7]=t=>o.form.phone=t),class:"ion-margin-bottom",type:"number",label:"Телефон","label-placement":"floating",fill:"outline",mode:"md"},null,8,["modelValue"]),e(b,{modelValue:o.form.unit,"onUpdate:modelValue":l[8]||(l[8]=t=>o.form.unit=t),class:"ion-margin-bottom",label:"Відділення","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"]),e(b,{modelValue:o.form.unit2,"onUpdate:modelValue":l[9]||(l[9]=t=>o.form.unit2=t),class:"ion-margin-bottom",label:"Взвод","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"]),e(b,{modelValue:o.form.unit3,"onUpdate:modelValue":l[10]||(l[10]=t=>o.form.unit3=t),class:"ion-margin-bottom",label:"Рота","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"]),e(b,{modelValue:o.form.unit4,"onUpdate:modelValue":l[11]||(l[11]=t=>o.form.unit4=t),class:"ion-margin-bottom",label:"Батальйон","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"]),e(b,{modelValue:o.form.unit5,"onUpdate:modelValue":l[12]||(l[12]=t=>o.form.unit5=t),class:"ion-margin-bottom",label:"Бригада","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"])]),_:1})]),_:1},8,["onWillDismiss"])],64)}const h=N(Y,[["render",Z]]),_=$({props:{report:{type:Object,default:()=>({})},type:{type:String,default:"create"}},components:{NewStaffModal:h,IonSegment:z,IonSegmentButton:H},setup(o){L();const l=v(!1),i=v({date:"",name:"",nickname:"",birthday:"",unit:"",rank:"",phone:"",location:"",situation:"",witnesses:"",diagnosis:"",help:"",tq:"",state:"",additional:"",lost:"",timePass:"",evacuatedBy:"",healthStatus:""});O(()=>o.report,a=>{a&&(i.value=a)},{deep:!0,immediate:!0});const s=v([]),V=v(!1);let w=null;const d=a=>{i.value.name=a.name,i.value.nickname=a.nickname,i.value.phone=a.phone,i.value.unit=a.unit+", "+a.unit2+", "+a.unit3+", "+a.unit4+", "+a.unit5,i.value.rank=a.rank+", "+a.workPosition,i.value.birthday=a.birthday};return{form:i,searchedStaffByNickame:s,onNameChange:async a=>{(a==null?void 0:a.length)>2?(s.value=await J(a),clearTimeout(w),s.value.length===0?w=setTimeout(()=>{s.value.length===0&&(V.value=!0)},2e3):V.value=!1):(clearTimeout(w),V.value=!1,s.value=[])},showNewStaffModal:V,selectStaff:a=>{d(a),s.value=[]},setStaffData:d,saveReport:async()=>{try{o.type==="edit"?(await K(i.value.id,i.value),window.location.href="/tabs/report/"+i.value.id):(await X(i.value),window.location.href="/tabs/tab1")}catch(a){alert("Помилка збереження репорту"),console.log(a)}},isFocused:l,onFocus:()=>{l.value=!0},onBlur:()=>{setTimeout(()=>{l.value=!1},150)}}}}),x={style:{display:"flex"}},oo={class:"input-wrapper"},lo={key:0,class:"autocomplete-tooltip"},eo={style:{"font-weight":"bold"}},no={class:"buttons-block",slot:"fixed"};function ao(o,l,i,s,V,w){const d=m("ion-label"),p=m("ion-segment-button"),c=m("ion-segment"),r=m("ion-input"),U=m("ion-item"),b=m("ion-list"),a=m("new-staff-modal"),f=m("ion-textarea"),B=m("ion-button"),t=m("ion-content");return k(),S(t,{class:"ion-padding"},{default:u(()=>{var D;return[e(c,{modelValue:o.form.healthStatus,"onUpdate:modelValue":l[0]||(l[0]=n=>o.form.healthStatus=n),class:"ion-segment"},{default:u(()=>[e(p,{class:"ion-segment-button",value:"200"},{default:u(()=>[e(d,null,{default:u(()=>[g("200")]),_:1})]),_:1}),e(p,{class:"ion-segment-button",value:"300"},{default:u(()=>[e(d,null,{default:u(()=>[g("300")]),_:1})]),_:1}),e(p,{class:"ion-segment-button",value:"Хвороба"},{default:u(()=>[e(d,null,{default:u(()=>[g("Хвороба")]),_:1})]),_:1})]),_:1},8,["modelValue"]),y("div",x,[y("div",oo,[e(r,{modelValue:o.form.nickname,"onUpdate:modelValue":l[1]||(l[1]=n=>o.form.nickname=n),class:"ion-margin-bottom",label:"Позивний (ПІБ)","label-placement":"floating",fill:"outline",mode:"md",debounce:500,onIonFocus:o.onFocus,onIonBlur:o.onBlur,onIonInput:l[2]||(l[2]=n=>o.onNameChange(o.form.nickname,"nickname"))},null,8,["modelValue","onIonFocus","onIonBlur"]),o.isFocused&&o.searchedStaffByNickame.length?(k(),I("div",lo,[e(b,null,{default:u(()=>[(k(!0),I(T,null,Q(o.searchedStaffByNickame,n=>(k(),S(U,{key:n.id,onClick:to=>o.selectStaff(n),button:""},{default:u(()=>[e(d,{class:"ion-text-wrap"},{default:u(()=>[y("div",eo,C(n.nickname),1),y("div",null,C(n.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])):F("",!0)]),o.type==="create"&&o.showNewStaffModal&&((D=o.form.nickname)==null?void 0:D.length)>3?(k(),S(a,{key:0,onNewStaff:o.setStaffData},null,8,["onNewStaff"])):F("",!0)]),e(r,{modelValue:o.form.name,"onUpdate:modelValue":l[3]||(l[3]=n=>o.form.name=n),class:"ion-margin-bottom",label:"ПІБ","label-placement":"floating",fill:"outline",mode:"md"},null,8,["modelValue"]),e(r,{modelValue:o.form.birthdate,"onUpdate:modelValue":l[4]||(l[4]=n=>o.form.birthdate=n),class:"ion-margin-bottom",label:"Дата народження","label-placement":"floating",fill:"outline",mode:"md"},null,8,["modelValue"]),e(f,{modelValue:o.form.unit,"onUpdate:modelValue":l[5]||(l[5]=n=>o.form.unit=n),class:"ion-margin-bottom",label:"Підрозділ","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"]),e(r,{modelValue:o.form.rank,"onUpdate:modelValue":l[6]||(l[6]=n=>o.form.rank=n),class:"ion-margin-bottom",label:"Звання, посада","label-placement":"floating",fill:"outline",mode:"md"},null,8,["modelValue"]),e(r,{modelValue:o.form.phone,"onUpdate:modelValue":l[7]||(l[7]=n=>o.form.phone=n),class:"ion-margin-bottom",type:"number",label:"Телефон","label-placement":"floating",fill:"outline",mode:"md"},null,8,["modelValue"]),e(r,{modelValue:o.form.date,"onUpdate:modelValue":l[8]||(l[8]=n=>o.form.date=n),class:"ion-margin-bottom",label:"Дата та час події","label-placement":"floating",fill:"outline",mode:"md"},null,8,["modelValue"]),e(r,{modelValue:o.form.location,"onUpdate:modelValue":l[9]||(l[9]=n=>o.form.location=n),class:"ion-margin-bottom",label:"Звання, посада","label-placement":"floating",fill:"outline",mode:"md"},null,8,["modelValue"]),e(r,{modelValue:o.form.situation,"onUpdate:modelValue":l[10]||(l[10]=n=>o.form.situation=n),class:"ion-margin-bottom",label:"Обставини","label-placement":"floating",fill:"outline",mode:"md"},null,8,["modelValue"]),e(r,{modelValue:o.form.witnesses,"onUpdate:modelValue":l[11]||(l[11]=n=>o.form.witnesses=n),class:"ion-margin-bottom",label:"Свідки","label-placement":"floating",fill:"outline",mode:"md"},null,8,["modelValue"]),e(f,{modelValue:o.form.diagnosis,"onUpdate:modelValue":l[12]||(l[12]=n=>o.form.diagnosis=n),class:"ion-margin-bottom",label:"Попередній діагноз","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"]),e(f,{modelValue:o.form.help,"onUpdate:modelValue":l[13]||(l[13]=n=>o.form.help=n),class:"ion-margin-bottom",label:"Надана допомога","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"]),e(f,{modelValue:o.form.tq,"onUpdate:modelValue":l[14]||(l[14]=n=>o.form.tq=n),class:"ion-margin-bottom",label:"TQ","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"]),e(f,{modelValue:o.form.state,"onUpdate:modelValue":l[15]||(l[15]=n=>o.form.state=n),class:"ion-margin-bottom",label:"Стан в динаміці","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"]),e(f,{modelValue:o.form.additional,"onUpdate:modelValue":l[16]||(l[16]=n=>o.form.additional=n),class:"ion-margin-bottom",label:"В засобах індивідуального захисту","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"]),e(f,{modelValue:o.form.lost,"onUpdate:modelValue":l[17]||(l[17]=n=>o.form.lost=n),class:"ion-margin-bottom",label:"Втрачене майно","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"]),e(f,{modelValue:o.form.timePass,"onUpdate:modelValue":l[18]||(l[18]=n=>o.form.timePass=n),class:"ion-margin-bottom",label:"Час передачі на","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"]),e(f,{modelValue:o.form.evacuatedBy,"onUpdate:modelValue":l[19]||(l[19]=n=>o.form.evacuatedBy=n),class:"last-input",label:"Ким евакуйований","label-placement":"floating","auto-grow":!0,fill:"outline",mode:"md"},null,8,["modelValue"]),y("div",no,[e(B,{expand:"block",color:"primary",shape:"round",style:{width:"100%"},onClick:o.saveReport},{default:u(()=>[g(" Зберегти ")]),_:1},8,["onClick"])])]}),_:1})}const io=N(_,[["render",ao],["__scopeId","data-v-ca1b6a29"]]);export{io as R};
